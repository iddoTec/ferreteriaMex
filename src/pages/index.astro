---
import BaseLayout from "../layouts/BaseLayout.astro";
import CarouselPC from "../components/CarouselTB.astro";
import CarouselTB from "../components/CarouselPC.astro";
import CarouselMB from "../components/CarouselMB.astro";


const carrusel1 = [
    {
        img: "public/img/facebook.png",
        nombre: "producto 1",
        descripcion:
            "Tanque de 180Lts marca CYTSA está fabricado con acero que cumple con especificaciones ASTM, con pintura anticorrosiva en polvo horneable color blanca aplicado con proceso electrostático espesor de 50 micrómetros, cuenta con válvulas de seguridad, llenado, servicio e indicador de nivel.",
        precio: "9500",
    },
    {
        img: "/public/img/facebook.png",
        nombre: "producto 2",
        descripcion:
            "Cuerpo de acero con recubrimiento de pintura electrostática, resistente a la corrosión",
        precio: "2150",
    },
    {
        img: "../../public/img/facebook.png",
        nombre: "producto 3",
        descripcion:
            "Cuerpo de acero con recubrimiento de pintura electrostática, resistente a la corrosión",
        precio: "2150",
    },
    {
        img: "../../public/img/facebook.png",
        nombre: "producto 4",
        descripcion:
            "Cuerpo de acero con recubrimiento de pintura electrostática, resistente a la corrosión",
        precio: "2150",
    },
    {
        img: "../../public/img/facebook.png",
        nombre: "producto 5",
        descripcion:
            "Cuerpo de acero con recubrimiento de pintura electrostática, resistente a la corrosión",
        precio: "2150",
    },
    {
        img: "../../public/img/facebook.png",
        nombre: "producto 6",
        descripcion:
            "Cuerpo de acero con recubrimiento de pintura electrostática, resistente a la corrosión",
        precio: "2150",
    },
    {
        img: "../../public/img/facebook.png",
        nombre: "producto 7",
        descripcion:
            "Cuerpo de acero con recubrimiento de pintura electrostática, resistente a la corrosión",
        precio: "2150",
    },
    {
        img: "../../public/img/facebook.png",
        nombre: "producto 8",
        descripcion:
            "Cuerpo de acero con recubrimiento de pintura electrostática, resistente a la corrosión",
        precio: "2150",
    },
];

---

<BaseLayout>
    <CarouselPC products={carrusel1}/>
    <CarouselTB products={carrusel1}/>
    <CarouselMB products={carrusel1}/>
</BaseLayout>

<script>
    import { supabase } from "../auth/supabaseClient";

    // Al cargar la página
    window.addEventListener("load", async () => {
        const { access_token, refresh_token, expires_in } = getURLParams();

        if (access_token) {
            // Pasa el token a Supabase para que establezca la sesión
            await supabase.auth.setSession({
                access_token,
                refresh_token,
            });

            // Limpia la URL para que no tenga los tokens
            window.history.replaceState({}, document.title, "/");
        }
    });

    function getURLParams() {
        const hash = window.location.hash;
        const params = new URLSearchParams(hash.substring(1)); // Eliminar el "#" al principio
        return {
            access_token: params.get("access_token"),
            refresh_token: params.get("refresh_token"),
            expires_in: params.get("expires_in"),
        };
    }
</script>
